{"title":"小程序分包","uid":"8cb2683bb6a5c8d0f688364471819883","slug":"小程序分包","date":"2024-05-10T07:08:26.000Z","updated":"2024-06-27T03:22:12.994Z","comments":true,"path":"api/articles/小程序分包.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":[],"content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>微信小程序分包常用于代码量较大的小程序，发布时会受到大小限制</p>\n<p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/fenbao1.png\"></p>\n<h3 id=\"什么是分包\"><a href=\"#什么是分包\" class=\"headerlink\" title=\"什么是分包\"></a>什么是分包</h3><p>分包指的是把一个完整的小程序项目，按照需求划分为不同的子包，在构建时打包成不同的分包，用户在使用时按需进行加载</p>\n<h3 id=\"分包的好处\"><a href=\"#分包的好处\" class=\"headerlink\" title=\"分包的好处\"></a>分包的好处</h3><p>可以优化小程序首次启动的下载时间<br>在多团队共同开发时可以更好的解耦协作</p>\n<h3 id=\"操作方式\"><a href=\"#操作方式\" class=\"headerlink\" title=\"操作方式\"></a>操作方式</h3><h4 id=\"1、建立分包文件夹\"><a href=\"#1、建立分包文件夹\" class=\"headerlink\" title=\"1、建立分包文件夹\"></a>1、建立分包文件夹</h4><p>在项目根目录下创建<br>分包文件夹 pageA、pageB： 只包含和当前分包有关的页面和私有资源；<br>pages 主包：一般只包含项目的启动页面或 TabBar 页面、以及所有分包都需要用到的一些公共资源。</p>\n<p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/fenbao2.png\"></p>\n<h4 id=\"2、文件配置\"><a href=\"#2、文件配置\" class=\"headerlink\" title=\"2、文件配置\"></a>2、文件配置</h4><p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/fenbao3.png\"></p>\n<h3 id=\"打包原则\"><a href=\"#打包原则\" class=\"headerlink\" title=\"打包原则\"></a>打包原则</h3><p>① 小程序会按 subpackages 的配置进行分包，subpackages 之外的目录将被打包到主包中<br>② 主包也可以有自己的 pages（(即最外层的 pages 字段)<br>③tabBar 页面必须在主包内<br>④ 分包之间不能互相嵌套</p>\n<h3 id=\"引用原则\"><a href=\"#引用原则\" class=\"headerlink\" title=\"引用原则\"></a>引用原则</h3><p>① 主包无法引用分包内的私有资源<br>② 分包之间不能相互引用私有资源<br>③ 分包可以引用主包内的公共资源</p>\n<h3 id=\"分包–独立分包\"><a href=\"#分包–独立分包\" class=\"headerlink\" title=\"分包–独立分包\"></a>分包–独立分包</h3><h4 id=\"1-什么是独立分包\"><a href=\"#1-什么是独立分包\" class=\"headerlink\" title=\"1.什么是独立分包\"></a>1.什么是独立分包</h4><p>独立分包本质上也是分包，只不过它比较特殊，可以独立于主包和其他分包而单独运行。</p>\n<h4 id=\"2、独立分包和普通分包的区别\"><a href=\"#2、独立分包和普通分包的区别\" class=\"headerlink\" title=\"2、独立分包和普通分包的区别\"></a>2、独立分包和普通分包的区别</h4><p>·普通分包必须依赖于主包才能运行<br>·独立分包可以在不下载主包的情况下，独立运行</p>\n<h4 id=\"3、独立分包的应用场景\"><a href=\"#3、独立分包的应用场景\" class=\"headerlink\" title=\"3、独立分包的应用场景\"></a>3、独立分包的应用场景</h4><p>开发者可以按需，将某些具有一定功能独立性的页面配置到独立分包中。原因如下:<br>当小程序从普通的分包页面启动时，需要首先下载主包<br>而独立分包不依赖主包即可运行，可以很大程度上提升分包页面的启动速度<br>注意:一个小程序中可以有多个独立分包。</p>\n<h4 id=\"4、独立分包的配置方法\"><a href=\"#4、独立分包的配置方法\" class=\"headerlink\" title=\"4、独立分包的配置方法\"></a>4、独立分包的配置方法</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;independent&quot;: true</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5、引用原则\"><a href=\"#5、引用原则\" class=\"headerlink\" title=\"5、引用原则\"></a>5、引用原则</h4><p>① 主包无法引用独立分包内的私有资源<br>② 独立分包之间，不能相互引用私有资源<br>③ 独立分包和普通分包之间，不能相互引用私有资源<br>**④ 特别注意:**独立分包中不能引用主包内的公共资源</p>\n<h4 id=\"分包–分包预下载\"><a href=\"#分包–分包预下载\" class=\"headerlink\" title=\"分包–分包预下载\"></a>分包–分包预下载</h4><h5 id=\"1-什么是分包预下载\"><a href=\"#1-什么是分包预下载\" class=\"headerlink\" title=\"1.什么是分包预下载\"></a>1.什么是分包预下载</h5><p>分包预下载指的是:在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而提升进入后续分包页面时的启动速度。</p>\n<h5 id=\"2-配置分包的预下载\"><a href=\"#2-配置分包的预下载\" class=\"headerlink\" title=\"2.配置分包的预下载\"></a>2.配置分包的预下载</h5><p>预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包的预下载规则，示例代码如下:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &quot;preloadRule&quot;: &#123;//分包预下载规则</span><br><span class=\"line\">   &quot;pages/contact/contact&quot;:&#123;//触发分包预下载的页面路径</span><br><span class=\"line\">   \t//packages表示进入页面后，预下载哪些分包</span><br><span class=\"line\">   \t//可以通过root或name指定预下载哪些分包</span><br><span class=\"line\">     &quot;packages&quot;: [&quot;p1&quot;],</span><br><span class=\"line\">     //network表示在指定的网络模式下进行预下载，</span><br><span class=\"line\"> //可选值为: all（不限网络）和 wifi（仅wifi模式下进行预下载）</span><br><span class=\"line\">//默认值为: wifi</span><br><span class=\"line\">     &quot;network&quot;: &quot;wifi&quot;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"> &#125;,</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","feature":true,"text":"前言微信小程序分包常用于代码量较大的小程序，发布时会受到大小限制 什么是分包分包指的是把一个完整的小程序项目，按照需求划分为不同的子包，在构建时打包成不同的分包...","permalink":"/post/小程序分包","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"总结","slug":"总结","count":2,"path":"api/categories/总结.json"}],"tags":[{"name":"小程序","slug":"小程序","count":1,"path":"api/tags/小程序.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%8C%85\"><span class=\"toc-text\">什么是分包</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%86%E5%8C%85%E7%9A%84%E5%A5%BD%E5%A4%84\"><span class=\"toc-text\">分包的好处</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">操作方式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%E3%80%81%E5%BB%BA%E7%AB%8B%E5%88%86%E5%8C%85%E6%96%87%E4%BB%B6%E5%A4%B9\"><span class=\"toc-text\">1、建立分包文件夹</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">2、文件配置</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%93%E5%8C%85%E5%8E%9F%E5%88%99\"><span class=\"toc-text\">打包原则</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%95%E7%94%A8%E5%8E%9F%E5%88%99\"><span class=\"toc-text\">引用原则</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%86%E5%8C%85%E2%80%93%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85\"><span class=\"toc-text\">分包–独立分包</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85\"><span class=\"toc-text\">1.什么是独立分包</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85%E5%92%8C%E6%99%AE%E9%80%9A%E5%88%86%E5%8C%85%E7%9A%84%E5%8C%BA%E5%88%AB\"><span class=\"toc-text\">2、独立分包和普通分包的区别</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%E3%80%81%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF\"><span class=\"toc-text\">3、独立分包的应用场景</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%E3%80%81%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">4、独立分包的配置方法</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%E3%80%81%E5%BC%95%E7%94%A8%E5%8E%9F%E5%88%99\"><span class=\"toc-text\">5、引用原则</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%88%86%E5%8C%85%E2%80%93%E5%88%86%E5%8C%85%E9%A2%84%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">分包–分包预下载</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%8C%85%E9%A2%84%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">1.什么是分包预下载</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#2-%E9%85%8D%E7%BD%AE%E5%88%86%E5%8C%85%E7%9A%84%E9%A2%84%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">2.配置分包的预下载</span></a></li></ol></li></ol></li></ol>","author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"uniapp之语音识别","uid":"4407c684d9dcb340bbb7fb0a49aa746d","slug":"uniapp之语音识别","date":"2024-05-23T03:42:24.000Z","updated":"2024-06-27T06:13:38.318Z","comments":true,"path":"api/articles/uniapp之语音识别.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":null,"text":"前言在hbuilder中引入百度语音识别集成平台，实现 AI语音识别 操作方式引入百度语音 manifest.json 文件 百度 AI 平台获取 key 值h...","permalink":"/post/uniapp之语音识别","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"经验","slug":"经验","count":3,"path":"api/categories/经验.json"}],"tags":[{"name":"uniapp","slug":"uniapp","count":1,"path":"api/tags/uniapp.json"},{"name":"语音识别","slug":"语音识别","count":1,"path":"api/tags/语音识别.json"}],"author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Vue-2-6源码分析之diff算法","uid":"6d3831836232ca9c37c73563d720e679","slug":"Vue-2-6源码分析之diff算法","date":"2024-07-24T07:45:20.000Z","updated":"2024-07-24T09:39:32.295Z","comments":true,"path":"api/articles/Vue-2-6源码分析之diff算法.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/vue-01.jpg","text":"虚拟DOM算法 虚拟DOM算法 = 虚拟DOM + Diff算法 虚拟DOM算法操作真实DOM，性能高于直接操作真实DOM 虚拟DOM123456<ul id=...","permalink":"/post/Vue-2-6源码分析之diff算法","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[{"name":"Vue","slug":"Vue","count":5,"path":"api/categories/Vue.json"},{"name":"总结","slug":"Vue/总结","count":5,"path":"api/categories/Vue/总结.json"},{"name":"Vue源码","slug":"Vue/总结/Vue源码","count":5,"path":"api/categories/Vue/总结/Vue源码.json"}],"tags":[{"name":"Vue","slug":"Vue","count":6,"path":"api/tags/Vue.json"},{"name":"Vue源码","slug":"Vue源码","count":5,"path":"api/tags/Vue源码.json"}],"author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}