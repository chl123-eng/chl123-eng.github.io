{"title":"如何缩小小程序主包大小","uid":"dc21ebec27b21dd15d905d44cdd109ba","slug":"如何缩小小程序主包大小","date":"2024-10-10T02:05:17.000Z","updated":"2024-10-10T02:40:32.585Z","comments":true,"path":"api/articles/如何缩小小程序主包大小.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/compress.jpg","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>如果要将一个很大的app迁移到小程序，那么必然会面临主包太大导致上传失败的问题。下面将从各个方面去压缩主包：</p>\n<h4 id=\"方法一：线上图片\"><a href=\"#方法一：线上图片\" class=\"headerlink\" title=\"方法一：线上图片\"></a>方法一：线上图片</h4><p>小程序体积大是因为static目录的图片资源过大的话，我们可以将static的图片上传图片服务器上去，小程序使用链接的形式来下载使用图片。</p>\n<h4 id=\"方法二：分包加载\"><a href=\"#方法二：分包加载\" class=\"headerlink\" title=\"方法二：分包加载\"></a>方法二：分包加载</h4><p>pages 主包：一般只包含项目的启动页面或 TabBar 页面、以及所有分包都需要用到的一些公共资源。</p>\n<p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/fenbao3.png\"></p>\n<h4 id=\"方法三：将TabBar页面迁移到子包\"><a href=\"#方法三：将TabBar页面迁移到子包\" class=\"headerlink\" title=\"方法三：将TabBar页面迁移到子包\"></a>方法三：将TabBar页面迁移到子包</h4><p>在小程序里面，如果是使用配置的方式开启tabBar导航，或者是使用这种官方自定义的方式，也就是我们通过在配置文件里面设置tabBar.custom等于true这样的方式实现tabBar导航组件，这个时候tabBar它页面地址只能放在主包里面，为了破除这个限制，我们可以使用自定义的方式实现tabBar的导航。</p>\n<div>\n  <div style=\"font-weight: 700\"> 过程：</div>\n  <ul>\n    <li>\n      在app.json配置文件里面将tabBar的配置删掉；\n    </li>\n    <li>\n      在components目录下面创建一个tabBar的组件；；\n    </li>\n    <li>\n      原定TabBar页面放到任何一个分包里面去\n    </li>\n  </ul>\n</div>\n\n\n<div>\n  <div style=\"font-weight: 700\"> 好处：</div>\n  <ul>\n    <li>\n      页面不再受分包的限制\n    </li>\n    <li>\n      tab-bar组件里边用到的图标，也不再被限制只能放在本地，上传成线上地址，减小主包大小；\n    </li>\n    <li>\n      所有的tabBar页面的跳转也不用再单独使用wx.switchTab这样的接口，可以统一使用wx.navigateTo或者是wx.redirectTo这两个接口任何一个都可以\n    </li>\n  </ul>\n</div>\n\n\n<h4 id=\"方法四：依赖的分离\"><a href=\"#方法四：依赖的分离\" class=\"headerlink\" title=\"方法四：依赖的分离\"></a>方法四：依赖的分离</h4><p>使用分包之后会发现遇到了一个奇怪的问题，子包的组件和js文件会被打包到主包的vendor.js文件中，这就导致了vendor.js过大。</p>\n <div style=\"font-weight: 700\"> manifest.json文件下的mp-weixin的subpackages节点时用来控制微信分包的，需要将此节点设为true</div>\n\n<p> <code> &quot;optimization&quot; : &#123;     &quot;subpackages&quot; : true &#125; </code></p>\n<h4 id=\"方法五：代码压缩\"><a href=\"#方法五：代码压缩\" class=\"headerlink\" title=\"方法五：代码压缩\"></a>方法五：代码压缩</h4><div style=\"font-weight: 700\">1、在HBuilder上面点击运行——>运行到小程序模拟器——>运行时是否压缩代码</div>\n\n<p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/b73d86eddcb74643a90ce0b029d5c5fa%7Etplv-k3u1fbpfcp-jj-mark_3024_0_0_0_q75.awebp\"></p>\n<div style=\"font-weight: 700\">2、在微信小程序上面点击设置——>项目设置</div>\n\n<p><img src=\"https://chlblog.oss-cn-guangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20241010103910.png\"></p>\n","text":"前言如果要将一个很大的app迁移到小程序，那么必然会面临主包太大导致上传失败的问题。下面将从各个方面去压缩主包： 方法一：线上图片小程序体积大是因为static...","permalink":"/post/如何缩小小程序主包大小","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"经验总结","slug":"经验总结","count":2,"path":"api/categories/经验总结.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E7%BA%BF%E4%B8%8A%E5%9B%BE%E7%89%87\"><span class=\"toc-text\">方法一：线上图片</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%88%86%E5%8C%85%E5%8A%A0%E8%BD%BD\"><span class=\"toc-text\">方法二：分包加载</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9A%E5%B0%86TabBar%E9%A1%B5%E9%9D%A2%E8%BF%81%E7%A7%BB%E5%88%B0%E5%AD%90%E5%8C%85\"><span class=\"toc-text\">方法三：将TabBar页面迁移到子包</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E5%9B%9B%EF%BC%9A%E4%BE%9D%E8%B5%96%E7%9A%84%E5%88%86%E7%A6%BB\"><span class=\"toc-text\">方法四：依赖的分离</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%94%EF%BC%9A%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9\"><span class=\"toc-text\">方法五：代码压缩</span></a></li></ol></li></ol>","author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"小程序分包","uid":"8cb2683bb6a5c8d0f688364471819883","slug":"小程序分包","date":"2024-05-10T07:08:26.000Z","updated":"2024-06-27T03:22:12.994Z","comments":true,"path":"api/articles/小程序分包.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":[],"text":"前言微信小程序分包常用于代码量较大的小程序，发布时会受到大小限制 什么是分包分包指的是把一个完整的小程序项目，按照需求划分为不同的子包，在构建时打包成不同的分包...","permalink":"/post/小程序分包","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"总结","slug":"总结","count":3,"path":"api/categories/总结.json"}],"tags":[{"name":"小程序","slug":"小程序","count":1,"path":"api/tags/小程序.json"}],"author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"重复请求取消","uid":"c1c5f0f95038546d7bb9b5b686492430","slug":"重复请求取消","date":"2024-08-30T06:08:51.000Z","updated":"2024-08-30T06:22:28.241Z","comments":true,"path":"api/articles/重复请求取消.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/compress.jpg","text":"场景模拟假设在一个电商网站中，用户在输入搜索关键字时，会触发搜索功能。如果用户输入过快，前一个搜索请求还未完成就发起了下一个，这时就需要取消前一个请求，确保只有...","permalink":"/post/重复请求取消","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"经验总结","slug":"经验总结","count":2,"path":"api/categories/经验总结.json"}],"tags":[],"author":{"name":"May","slug":"blog-author","avatar":"https://chlblog.oss-cn-guangzhou.aliyuncs.com/logo.jpg","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}