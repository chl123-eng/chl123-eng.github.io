{"title":"HTTP缓存机制记录","uid":"977046a105528b08c6104c9e8e95e023","slug":"HTTP缓存机制记录","date":"2019-12-03T16:00:00.000Z","updated":"2024-06-07T03:20:18.000Z","comments":true,"path":"api/articles/HTTP缓存机制记录.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/http01.png","content":"<p>http 缓存机制很容易就忘记了 这里大概记录一下</p>\n<h2 id=\"简单概括\"><a href=\"#简单概括\" class=\"headerlink\" title=\"简单概括\"></a>简单概括</h2><p>http 缓存分为强缓存(Cache-Control &gt; Expires),协商缓存(Etag &#x2F; If-None-Match &gt; Last-Modified &#x2F; If-Modified-Since)强缓存和协商缓存的区别&gt; 强缓存命中的情况下不和服务器做交互，协商缓存不管有没有命中都会和服务器做交互</p>\n<h2 id=\"第一次请求\"><a href=\"#第一次请求\" class=\"headerlink\" title=\"第一次请求\"></a>第一次请求</h2><ol>\n<li>浏览器发起 http 请求到服务器。</li>\n<li>http 请求通过浏览器缓存，浏览器缓存没有发现该请求的缓存标识和缓存结果，会直接放行，让 http 请求直接请求到服务器。</li>\n<li>服务器返回请求结果和缓存规则给浏览器</li>\n<li>浏览器将请求结果和缓存标识存入浏览器缓存中，作为下一次请求的标识</li>\n</ol>\n<h2 id=\"第二次请求命中强缓存的情况\"><a href=\"#第二次请求命中强缓存的情况\" class=\"headerlink\" title=\"第二次请求命中强缓存的情况\"></a>第二次请求命中强缓存的情况</h2><ul>\n<li>Expires 该字段作为缓存标志， 如果客户端的时间小于 Expires 的值时，就直接使用缓存结果，但是这只是存在于 HTTP&#x2F;1.0 中，现今大部分已经被 Cache-Control 所替代</li>\n<li>Cache-Control HTTP1.1 所使用的标识，该字段有以下几种属性</li>\n<li>public：所有内容都将被缓存（客户端和代理服务器都可缓存）</li>\n<li>private：所有内容只有客户端可以缓存，Cache-Control 的默认取值</li>\n<li>no-cache：客户端缓存内容，但是是否使用缓存则需要经过协商缓存来验证决定</li>\n<li>no-store：所有内容都不会被缓存，即不使用强制缓存，也不使用协商缓存</li>\n<li>max-age&#x3D;xxx (xxx is numeric)：缓存内容将在 xxx 秒后失效</li>\n</ul>\n<h2 id=\"第二次请求\"><a href=\"#第二次请求\" class=\"headerlink\" title=\"第二次请求\"></a>第二次请求</h2><ul>\n<li>强缓存未命中，协商缓存命中的情况当协商缓存命中时，服务器返回 304 状态码表示该资源没有更新协商缓存字段有 Last-Modified &#x2F; If-Modified-Since 和 Etag &#x2F; If-None-Match，其中 Etag &#x2F; If-None-Match 的优先级比 Last-Modified &#x2F; If-Modified-Since 高。</li>\n<li>If-None-Match&#x2F;Etag &#x3D;&gt; 客户端再次发起该请求时，携带上次请求返回的唯一标识 Etag 值，通过此字段值告诉服务器该资源上次请求返回的唯一标识值。服务器收到该请求后，发现该请求头中含有 If-None-Match，则会根据 If-None-Match 的字段值与该资源在服务器的 Etag 值做对比，一致则返回 304，代表资源无更新，继续使用缓存文件；不一致则重新返回资源文件，返回 200</li>\n<li>Last-Modified&#x2F;If-Modified-Since &#x3D;&gt; 则是客户端再次发起该请求时，携带上次请求返回的 Last-Modified 值，通过此字段值告诉服务器该资源上次请求返回的最后被修改时间。服务器收到该请求，发现请求头含有 If-Modified-Since 字段，则会根据 If-Modified-Since 的字段值与该资源在服务器的最后被修改时间做对比，若服务器的资源最后被修改时间大于 If-Modified-Since 的字段值，则重新返回资源，状态码为 200；否则则返回 304，代表资源无更新，可继续使用缓存文件</li>\n</ul>\n","text":"http 缓存机制很容易就忘记了 这里大概记录一下 简单概括http 缓存分为强缓存(Cache-Control > Expires),协商缓存(Etag / ...","permalink":"/post/HTTP缓存机制记录","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"http","slug":"http","count":2,"path":"api/categories/http.json"},{"name":"总结","slug":"http/总结","count":1,"path":"api/categories/http/总结.json"}],"tags":[{"name":"http","slug":"http","count":4,"path":"api/tags/http.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AE%80%E5%8D%95%E6%A6%82%E6%8B%AC\"><span class=\"toc-text\">简单概括</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%B7%E6%B1%82\"><span class=\"toc-text\">第一次请求</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AF%B7%E6%B1%82%E5%91%BD%E4%B8%AD%E5%BC%BA%E7%BC%93%E5%AD%98%E7%9A%84%E6%83%85%E5%86%B5\"><span class=\"toc-text\">第二次请求命中强缓存的情况</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AF%B7%E6%B1%82\"><span class=\"toc-text\">第二次请求</span></a></li></ol>","author":{"name":"谢小谢","slug":"blog-author","avatar":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/logo24.png","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"记一次企业微信WX JS-SDK的不同设备下的问题","uid":"baf239d953fd03e4fb1a47a4e7060466","slug":"记一次企业微信WX JS-SDK的不同设备下的问题","date":"2020-09-13T16:00:00.000Z","updated":"2024-06-07T03:20:18.000Z","comments":true,"path":"api/articles/记一次企业微信WX JS-SDK的不同设备下的问题.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/js-sdk-01.png","text":"问题记录: 最近在一次企业微信的 jssdk 的调用过程中发现 IOS 设备下在功能页初始化配置微信 js-sdk 无效。 解决方法: Android 下获取微...","permalink":"/post/记一次企业微信WX JS-SDK的不同设备下的问题","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"经验","slug":"经验","count":6,"path":"api/categories/经验.json"}],"tags":[{"name":"canvas","slug":"canvas","count":3,"path":"api/tags/canvas.json"},{"name":"js-sdk","slug":"js-sdk","count":1,"path":"api/tags/js-sdk.json"}],"author":{"name":"谢小谢","slug":"blog-author","avatar":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/logo24.png","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DockerCompose一键配置nginx,mysql环境","uid":"f88c08d2432ee83789750b7f28e6e54e","slug":"DockerCompose一键配置nginx,mysql环境","date":"2019-12-02T16:00:00.000Z","updated":"2024-06-07T03:20:18.000Z","comments":true,"path":"api/articles/DockerCompose一键配置nginx,mysql环境.json","keywords":"蔡惠霖的博客，前端开发，Vue，Node.js","cover":"https://www.xiesmallxie.cn/docker.jpeg","text":"之前一直觉得把 mysql 和 nginx 环境分别分开部署很不好，一旦服务器宕机，又得找到对应的目录开启对应的指令，后面发现了 docker 可以用来一次性部...","permalink":"/post/DockerCompose一键配置nginx,mysql环境","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"docker部署","slug":"docker部署","count":1,"path":"api/categories/docker部署.json"}],"tags":[{"name":"nginx","slug":"nginx","count":1,"path":"api/tags/nginx.json"},{"name":"docker","slug":"docker","count":1,"path":"api/tags/docker.json"}],"author":{"name":"谢小谢","slug":"blog-author","avatar":"https://blog-1300014307.cos.ap-guangzhou.myqcloud.com/logo24.png","link":"/","description":"Love Music, love life","socials":{"github":"https://github.com/ShuHongXie","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}